import pandas as pd

# 合成训练集合
df1 = pd.read_csv(r'../../csv/final_apis_combined.csv', index_col=0)
print("df1.shape:", df1)

df2 = pd.read_csv(r'../../csv/final_permissions_combined.csv', index_col=0)
print("df2.shape:", df2)

# df3 = df2.merge(df1, left_index=True, right_index=True).reset_index(drop=True)
# df3 = df2.join(df1).reset_index(drop=True)
df3 = df2.join(df1, lsuffix='_left', rsuffix='_right').reset_index(drop=True)
print("df3.shape:", df3)

df3.fillna(0, inplace=True)
df4 = df3.loc[:, (df3 != 0).any(axis=0)]
# 删除type_right
df4.drop(['type_right'], axis=1, inplace=True)
print(df4.shape)
# 将type_left 重命名为type
df4 = df4.rename(columns={'type_left': 'type'})
# print(df4['type'])

# 输出type对应的统计
# print(df4[df4['type'] == 0].count())

df4.to_csv(r'../../csv/final_training_set.csv')
# print(df4)
