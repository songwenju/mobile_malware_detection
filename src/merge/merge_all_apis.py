import pandas as pd

from src.Constant import all_benign_apis_csv, all_malicious_apis_csv, final_apis_combined_csv


def merge_all_apis():
    # 将malicious apis  与benign apis合并
    df = pd.read_csv(all_benign_apis_csv, index_col=0)
    print("df.shape:", df.shape)
    df1 = pd.read_csv(all_malicious_apis_csv, index_col=0)
    print("df1.shape:", df1.shape)
    df2 = df1.append(df, ignore_index=True)
    print("df2.shape:", df2.head())
    # 填充0
    df2.fillna(0, inplace=True)
    print("df2.shape:", df2.head())
    # any(axis=0)]查看列
    # any(axis=1) 查看行
    # 是哟loc筛选出具体数据
    df3 = df2.loc[:, (df2 != 0).any(axis=0)]
    print("df3:", df3)
    # 将df1 存到final开头的apis里了
    df3.to_csv(final_apis_combined_csv)


if __name__ == '__main__':
    merge_all_apis()
