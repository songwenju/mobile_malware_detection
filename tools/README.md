# Android Malware Detection #

我的研究是关于 Android 恶意软件检测。该存储库提供用于静态分析的 api 和脚本。为了快速开发，大多数代码都是用 Python 编写的。

## Overview ##

静态分析的工作流程和大多数机器学习应用一样: 获取数据集，提取特征，并对样本进行分类。

### Dataset Acquisition ###

有几种方法可以获得 APK 文件。你可以从 Google Play 或者像 Wandoujia 这样的三方应用商店下载。从 Google Play 下载 APK 文件可能需要额外的工具，
比如 [APKs Downloader][3]。 请注意，每个谷歌账户每天的配额大约是300到500个 APK 文件。
一个账户收集一万个应用程序需要一个多月的时间。

下载后，我们应该将 APK 文件标记为恶意或良性的。一些论文相信所有来自 Google Play 的样本都是良性的，并且使用了[Android Malware Genome Project][5]提供的恶意数据集。
然而，这个方案太粗糙了，因为恶意应用程序可能存在于 Google Play 中。不是万能的。

[VirusTotal][4] 是另一种做这项工作的常用方法。它提供了一个公共 API，可以通过几个反病毒扫描器在线扫描任意文件。
一篇论文 [Drebin][6] 将这些应用程序标记为至少被十种常见扫描仪中的两种检测到的恶意程序，
并将它们与安卓恶意软件基因组计划结合起来。另一篇论文 [MAMA][7] 控制检测率的所有扫描仪经验。

### 数据集获取 ###

APK 文件中的所有内容都可以是一个特性。最基本和最常见的特性是权限和 api。后者由于粒度细小，已经统治了近两年时间。
您可以使用基于 python 的 [Androguard][8] 或基于 java 的 [Baksmali][9]  反汇编 APK 文件，并获得所需的特性。我选择前者是因为写 Python 脚本对我来说更直观。

### 分类 ###

有许多算法可以应用，如贝叶斯网络，支持向量机(SVMs) ，J48等。你可以自己实现这些算法。但是，作为一名程序员，
我建议您使用像 scikit-learn (基于 python)和 Weka (基于 java)这样的库。

如果您还没有决定使用哪种算法，我推荐 Weka 作为起点。它提供了一个很好的图形用户界面，这样你就可以简单地通过鼠标来做很多事情，这在开始的时候是很方便的。
如果你是一个 Java 爱好者，你也可以用基于 Java 的 Weka API 编写复杂的分类方案。

## Development Environment ##


* Python 2.7.6

三个 python 模块，psycopg 和 poster，分别用于数据库操作和通过 HTTP 上传文件。使用 apt-get 安装它们:

  ```bash
  $ sudo apt-get install python-psycopg2 python-poster
  ```

* Weka 3.6.11

下载 Weka 后，切换到目录并输入以下命令执行 ti:
  ```bash
  $ java -Xmx1000M -jar weka.jar
  ```
注意，using-jar 将覆盖 CLASSPATH 变量，并且只使用 weka.jar。顺便说一下，我更喜欢另一种方式。首先将路径添加到 bashrc 中的 CLASSPATH:
  ```bash
  export CLASSPATH=/path/to/weka:$CLASSPATH
  ```
之后你可以在任何地方运行这个程序:
  ```bash
  $ java weka.gui.GUIChooser
  # or java weka.gui.Main
  ```
如果你的操作系统是 Ubuntu，你会发现它的标签完成非常方便。最后，如果需要，不要忘记将 SVM Java 库添加到 CLASSPATH 变量中。



<!-- ## References -->


<!-- Link Labels -->
[1]: https://play.google.com "Google Play"
[2]: http://www.wandoujia.com/apps "Wandoujia"
[3]: https://github.com/Machiry/Android "APK Downloader"
[4]: https://www.virustotal.com "VirusTotal"
[5]: http://www.malgenomeproject.org "Android Malware Genome Project"
[6]: http://www.prosec-project.org/docs/2014-ndss.pdf "Drebin"
[7]: http://www.tandfonline.com/doi/abs/10.1080/01969722.2013.803889 "MAMA"
[8]: https://github.com/androguard/androguard "Androguard"
[9]: https://bitbucket.org/JesusFreke/smali "baksmali"
[10]: http://scikit-learn.org "scikit learn"
[11]: http://www.cs.waikato.ac.nz/ml/weka "weka"
[12]: https://pypi.python.org/pypi/virtualenv "virtualenv"
